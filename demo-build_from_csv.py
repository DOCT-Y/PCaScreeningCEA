import pandas as pd

from utils import parse_parameters, parse_model


node_df = pd.read_csv('./demo nodes.csv')
transition_df = pd.read_csv('./demo transitions.csv')

param_df = pd.read_csv('./demo parameters.csv')
parameters = parse_parameters(param_df)

controller = parse_model(node_df, transition_df, parameters, total_cycles=20, count_method='half', discount_rate=0.02)

prob_df, variable_df = controller.run()

print(prob_df)
print(variable_df)
print(variable_df.sum(axis=0))

'''
     state_a   state_b   state_c
0   0.899950  0.100000  0.000050
1   0.749524  0.249276  0.001200
2   0.673450  0.322608  0.003942
3   0.634306  0.358178  0.007515
4   0.613491  0.374967  0.011542
5   0.601760  0.382407  0.015833
6   0.594518  0.385188  0.020294
7   0.589484  0.385639  0.024878
8   0.585523  0.384917  0.029560
9   0.582074  0.383599  0.034327
10  0.578858  0.381970  0.039173
11  0.575735  0.380172  0.044093
12  0.572638  0.378277  0.049085
13  0.569534  0.376320  0.054146
14  0.566407  0.374318  0.059275
15  0.563248  0.372282  0.064470
16  0.560054  0.370215  0.069730
17  0.556825  0.368121  0.075054
18  0.553560  0.366001  0.080439
19  0.550259  0.363856  0.085885

         cost   utility
0   55.597450  0.959950
1   67.760589  0.846428
2   77.731069  0.747738
3   81.518555  0.691621
4   82.314903  0.656407
5   81.675135  0.631534
6   80.356570  0.611854
7   78.727831  0.594857
8   76.968164  0.579318
9   75.164562  0.564638
10  73.359087  0.550524
11  71.571924  0.536829
12  69.812601  0.523481
13  68.085464  0.510443
14  66.392336  0.497694
15  64.733813  0.485220
16  63.109900  0.473016
17  61.520310  0.461073
18  59.964621  0.449388
19  58.442347  0.437956

cost       1414.807232
utility      11.809972
'''
